# λ΅λ“λ°Έλ°μ‹±
μ‘μ„±μΌ : 2024-01-02

μ‘μ„±λ©μ  : AWS λ΅λ“ λ°Έλ°μ¤ μ‚¬μ©μ„ μ„ν• μ›λ¦¬ νμ•…

## κ°μ”
μ¶”λ΅  RESTful API μ„λ²„λ¥Ό κ°λ°ν•λ©΄μ„ ν•΄λ‹Ή μ„λ²„λ¥Ό GPU 3λ€μ— λ¶„λ¦¬ν•μ—¬ λ„μ»¤ μ»¨ν…μ΄λ„λ΅ λ¶„μ‚°ν•μ—¬ μ¶”λ΅  μ‹κ°„μ„ μ¤„μ΄κ³  μ‚¬μ©μ λ”λ μ΄λ¥Ό μµμ†ν™” ν•λ ¤κ³  ν•λ‹¤.
μ΄λ–„ 3λ€μ GPUλ¥Ό κ°κ° EC2 μΈμ¤ν„΄μ¤μ— ν• λ‹Ήν•΄μ£Όκ³  λ΅λ“λ°Έλ°μ„λ¥Ό ν†µν•΄μ„ ν•΄λ‹Ή λ¶€ν•λ¥Ό λ‚λ„μ–΄ μ¤„κ²ƒμ΄λ‹¤.
λ΅λ“ λ°Έλ°μ‹±μ΄λΌλ” κ²ƒμ΄ κ°κ° λ¦¬ν€μ¤νΈκ°€ λ°λ¦¬λ” μƒν™©μ—μ„ μ§‘μ¤‘λ λ¦¬ν€μ¤νΈλ¥Ό λ¶„μ‚°ν•λ” κ²ƒμ΄λΌκ³ λ§ μ•κ³  μλ”λ° μ •ν™•ν•κ² κ°λ…μ„ μ§‘κ³  ν•΄λ‹Ή μƒν™©μ„ λ„μ–΄κ°€λ³΄μ

## λ΅λ“λ°Έλ°μ‹±(Load Balnancing)
λ‘ νΉμ€ μ…‹ μ΄μƒμ μ¤‘μ•™μ²λ¦¬ μ¥μΉ νΉμ€ μ €μ¥μ¥μΉμ™€ κ°™μ€ μ»΄ν“¨ν… λ¦¬μ†μ¤μ—κ² μ‘μ—…(work)
λ¥Ό λ‚λ„λ” κ²ƒ, μ¦‰ λ¶€ν•(Load)λ¥Ό λ‚λ„λ” κ²ƒμ„ μλ―Έν•λ‹¤.
μ΄λ¥Ό ν†µν•΄μ„ κ°€μ©μ„± λ° μ‘λ‹µμ‹κ°„μ„ μµμ ν™” ν•λ‹¤.

>νμ‚¬λ¥Ό μμ‹λ¥Ό ν†µν•μλ§ ν•λ‚μ ν”„λ΅μ νΈ κ·λ¨κ°€ μ»¤μ Έμ„ νΌμ μ³λ‚΄λ μ—…λ¬΄ λ¶„μ¥μ„ μ„ν•΄μ„ κ³„μ•½μ§ μ§μ›μ„ λ“¤μΈλ‹¤ μ΄λ° λλ‚μ΄λ‹¤.

![](https://velog.velcdn.com/images/kimdodo/post/920dc10b-1e14-4b62-b54d-a740b90da6b9/image.png)

λ΅λ“ λ°Έλ°μ¤λ¥Ό λ³΄μ—¬μ£Όλ” μμ‹ κ·Έλ¦Όμ΄λ‹¤.
λ΅λ“ λ°Έλ°μ¤λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­ λ° λ„¤νΈμ›ν¬ νΈλν”½μ΄ μ§‘μ¤‘λλ” μ„λ²„λ“¤(Server Pool/ Server Farm) λλ” λ„¤νΈμ›ν¬ ν—λΈ μ‚¬μ΄μ— μ„μΉν•΄μ„ νΉμ • μ„λ²„ λλ” λ„¤νΈμ›ν¬ ν—λΈμ— λ¶€ν•κ°€ μ§‘μ¤‘λμ§€ μ•κ² νΈλν”½μ„ λ¶„μ‚°ν•λ” κ²ƒ

### κΈ°λ³Έ κΈ°λ¥
1. #### Health Check (μƒνƒ ν™•μΈ)
- μ„λ²„λ“¤μ— λ€ν• μ£ΌκΈ°μ μΈ ν—¬μ¤ μ²΄ν¬λ¥Ό ν†µν•΄μ„ μ„λ²„ μ¥μ•  μ—¬λ¶€λ¥Ό νμ•…
μ •μƒ λ™μ‘ μ„λ²„μ—λ§ νΈλν”½ λ³΄λƒ„
- L3 μ²΄ν¬ : ICMPλ¥Ό μ΄μ©ν•΄μ„ μ„λ²„μ **IP μ£Όμ†κ°€ ν†µμ‹  κ°€λ¥**μΈμ§€ ν™•μΈ
- L4 μ²΄ν¬ : TCPλ”** 3Way-handshak**e κΈ°λ° ν†µμ‹ , μ΄ νΉμ„±μ„ λ°”νƒ•μΌλ΅ κ° ν¬νΈ μƒνƒ μ²΄ν¬
- L7 μ²΄ν¬ : μ–΄ν”λ¦¬μΌ€μ΄μ… κ³„μΈµμ—μ„ μ²΄ν¬λ¥Ό μν–‰, **μ‹¤μ  μ›Ή νμ΄μ§€ ν†µμ‹ ** μ‹λ„

2. #### Tunneling(ν„°λ„λ§)
- λ°μ΄ν„° μ¤νΈλ¦Όμ„ μΈν„°λ„· μƒμ—μ„ κ°€μƒμ νμ΄ν”„λ¥Ό ν†µν•΄ μ „λ‹¬μ‹ν‚¤λ” κΈ°μ 
- μ—°κ²°λ μƒνΈ κ°„μ—λ§ μΊ΅μν™”λ ν¨ν‚·μ„ κµ¬λ³„ν•΄ μΊ΅μν™” ν•΄μ 

3. #### NAT(Netwrok Address Translation)
- λ‚΄λ¶€ λ„¤νΈμ›ν¬μ μ‚¬μ„¤ IP μ£Όμ†, λ΅λ“λ°Έλ°μ„ μ™Έλ¶€μ κ³µμΈ IP μ£Όμ†κ°„μ λ³€ν™ μ—­ν• 
- λ΅λ“ λ°Έλ°μ‹± κ΄€μ μ—μ„λ” μ—¬λ¬κ°μ νΈμ¤νΈκ°€ ν•λ‚μ κ³µμΈ μ£Όμ† IP λ¥Ό ν†µν•΄μ„ μ ‘μ†ν•λ” κ²ƒμ΄ λ©ν‘
- SNAT(Source Network Address Translation)
λ‚΄λ¶€μ—μ„ μ™Έλ¶€λ΅ λ‚κ°€λ” νΈλν”½ (λ‚΄λ¶€ μ‚¬μ„¤ IP --> μ™Έλ¶€ κ³µμΈ IP)
- DNAT(Source Network Address Translation)
μ™Έλ¶€μ—μ„ λ‚΄λ¶€λ΅ νΈλν”½(μ™Έλ¶€ κ³µμΈ IP ----> λ‚΄λ¶€ μ‚¬μ„¤ IP)

4. #### DSR(Destination Network Address Translation)
- μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅ νΈλν”½μ΄ λλμ•„κ°€λ” κ²½μ°, λ©μ μ§€λ¥Ό ν΄λΌμ΄μ–ΈνΈλ΅ μ„¤μ •ν• λ‹¤μ, λ„¤νΈμ›ν¬ μ¥λΉ„λ‚ λ΅λ“λ°Έλ°μ„λ¥Ό κ±°μΉμ§€ μ•κ³  ν΄λΌμ΄μ–ΈνΈλ¥Ό μ°Ύμ•„κ°
- λ΅λ“λ°Έλ°μ„μ λ¶€ν• κ°μ†

## λ΅λ“λ°Έλ°μ‹± μ•κ³ λ¦¬μ¦
1. #### RR(Round Robin)
μ„λ²„μ— λ“¤μ–΄μ¨ μ”μ²­ μμ„λ€λ΅ λμ•„κ°€λ©° λ°°μ •
ν΄λΌμ΄μ–ΈνΈμ μ”μ²­λ€λ΅ μμ„ λ¶„λ°°, μ„λ²„λ“¤μ΄ λ™μΌ μ¤ν™ λ° μ—°κ²°μ΄ μ¤λ μ§€μ†λμ§€ μ•λ” κ²½μ° μ ν•©

2. #### κ°€μ¤‘ λΌμ΄λ“λ΅λΉ λ°©μ‹(Weighted Round Robin)
κ° μ„λ²„λ§λ‹¤ κ°€μ¤‘μΉλ¥Ό κ°€μ§€κ³  κ°€μ¤‘μΉκ°€ λ†’μ€ μ„λ²„μ— ν΄λΌμ΄μ–ΈνΈ μ°μ„  λ°°μΉ
μ„±λ¥μ΄ λ†’μ€ μ„λ²„κ°€ κ°€μ¤‘μΉκ°€ λ†’κ² λ‹¤

3. #### IP ν•΄μ‹ λ°©μ‹
ν΄λΌμ΄μ–ΈνΈ IP μ£Όμ†λ¥Ό νΉμ • μ„λ²„λ΅ λ§¤ν•‘ν•μ—¬ μ”μ²­ μ²λ¦¬
μ‚¬μ©μ IPλ¥Ό ν•΄μ‹±ν•μ—¬ λ¶€ν• λ¶„μ‚° μ‚¬μ©μκ°€ ν•­μƒ λ™μΌ μ„λ²„λ΅ μ—°κ²°
> μ•„μ§ GPU 3λ€μ— λ¶„μ‚°μ„ μ–΄λ–»κ² ν• μ§€ λ¨λ¥΄μ§€λ§ μ‚¬μ΄νΈλ³„λ΅ λ‚λλ‹¤λ©΄ μ μ©ν• κ²ƒμΌλ΅ λ³΄μ„

4. #### μµμ† μ—°κ²° λ°©μ‹
λ¦¬ν€μ¤νΈκ°€ λ“¤μ–΄μ¨ μ‹μ μ—μ„ κ°€μ¥ μ μ€ μ„Έμ… μƒνƒλ¥Ό λ³΄μ΄λ” μ„λ²„μ— μ°μ„  ν• λ‹Ή
μ„Έμ…μ΄ κΈΈμ–΄μ§€κ±°λ‚, μ„λ²„μ— λ¶„λ°°λ νΈλν”½μ΄ μΌμ •ν•μ§€ μ•μ€ κ²½μ°

5. #### μµμ† μ‘λ‹µμ‹κ°„ λ°©μ‹
μ„λ²„μ ν„μ¬ μ—°κ²° μƒνƒ λ° μ‘λ‹µμ‹κ°„μ„ κ³ λ ¤, κ°€μ¥ μ§§μ€ μ‘λ‹µμ‹κ°„μ„ λ³΄λ‚΄λ μ„λ²„λ΅ νΈλν”½
κ° μ„λ²„λ“¤μ κ°€μ©ν• λ¦¬μ†μ¤μ™€ μ„±λ¥, μ²λ¦¬μ¤‘μΈ λ°μ΄ν„°μ–‘μ΄ μƒμ΄ν•  κ²½μ°
> 3λ€κ°€ λ¨λ‘ λ™μΌν• μ²λ¦¬λ¥Ό ν•λ” κ²½μ°μ—λ” μΆ‹μ

6. #### λ€μ—­ν­ λ°©μ‹
μ„λ²„λ“¤κ³Όμ λ€μ—­ν­μ„ κ³ λ ¤ν•λ” λ°©μ‹

## L4 / L7
λ€λ¶€λ¶„μ λ΅λ“λ°Έλ°μ„λ” L4 λλ” L7 λ΅λ“λ°Έλ°μ„λ¥Ό μ‚¬μ©

### 1. L4
4κ³„μΈµ μ¦‰ λ„¤νΈμ›ν¬ κ³„μΈµ(IP)λ‚ 3κ³„μΈµ(TCP/UDP) μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ λ΅λ“λ¥Ό λ¶„μ‚°ν•λ” λ°©μ‹
IPμ£Όμ†, ν¬νΈλ²νΈ, MAC μ£Όμ† λ“± μ „μ†΅ ν”„λ΅ν† μ½μ— λ”°λΌμ„ νΈλν”½μ„ λ¶„μ‚°ν•λ‹¤.

![](https://velog.velcdn.com/images/kimdodo/post/ea7e9506-284f-49b1-a5c3-92a7d206895b/image.png)

#### π‘μ¥μ 
>π‘‰ ν¨ν‚·μ λ‚΄μ©μ„ ν™•μΈν•μ§€ μ•κ³  λ΅λ“ λ¶„μ‚°(μ†λ„ ν¨μ¨ λ†’μ)
π‘‰ λ°μ΄ν„°μ λ‚΄μ©μ„ λ³µνΈν™”ν•  ν•„μ”κ°€ μ—†κΈ°μ— μ•μ „
π‘‰ L7 λ΅λ“λ°Έλ°μ„ λ³΄λ‹¤ κ°€κ²©μ΄ μ €λ ΄

#### π‘λ‹¨μ 
> π‘‰ ν¨ν‚· λ‚΄μ©μ„ λ¨λ¥΄κΈ° λ•λ¬Έμ— μ„¬μ„Έν• λΌμ°ν… λ¶κ°€
π‘‰ μ‚¬μ©μμ IPκ°€ μμ‹λ΅ λ°”λ€λ©΄ μ—°μ†μ  μ„λΉ„μ¤ λ¶κ°€

### 1. L7
λ„¤νΈμ›ν¬ 7κ³„μΈµ μ¦‰ μ–΄ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ(HTTP,FTP,SMTP) μ—μ„ λ΅λ“ λ¶„μ‚°
HTTPν—¤λ”λ‚ μΏ ν‚¤ κ°™μ€ μ‚¬μ©μ μ”μ²­ κΈ°μ¤€ λ¶„λ¦¬

![](https://velog.velcdn.com/images/kimdodo/post/1487e35e-69f5-4141-8bed-d0d5bc75d3fe/image.png)

L4μ—μ„ λ” λ‚μ•„κ°€ ν¨ν‚· λ‚΄μ©μ„ ν™•μΈν•κ³  λ‚΄μ©μ— λ”°λΌμ„ λ΅λ“λ¥Ό νΉμ„± μ„λ²„μ— λ¶„λ°°
ν¨ν„΄μ„ νμ•…ν• λ°”μ΄λ¬μ¤ νƒμ§€ λ“± λ³΄μ•μ„±μ΄ μΆ‹μ

- URL μ¤μ„μΉ­
νΉμ • ν•μ„ URLλ“¤μ€ νΉμ„± μ„λ²„λ΅ μ²λ¦¬ν•λ” λ°©μ‹
- μ»¨ν…μ¤νΈ μ¤μ„μΉ­
ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­ν• νΉμ • λ¦¬μ†μ¤μ— λ€ν•΄ νΉμ • μ„λ²„λ΅ μ—°κ²°
μ΄λ―Έμ§€λ‚ λ™μμƒμ ν™•μ¥μλ¥Ό μ°Έμ΅°ν•΄ ν•΄λ‹Ή μ΄λ―Έμ§€ μ„λ²„λ΅ μ—°κ²° ν•λ‹¤λκ°€
- μΏ ν‚¤ μ§€μ†μ„±
μΏ ν‚¤ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°ν–μ—λ λ™μΌν• μ„λ²„μ— κ³„μ† ν• λ‹Ή
μ‚¬μ„¤ λ„¤νΈμ›ν¬μ— μλ ν΄λΌμ΄μ–ΈνΈμ IPμ£Όμ†κ°€ κ³µμΈ IP μ£Όμ†λ΅ μΉν™ μ „μ†΅

#### π‘μ¥μ 
>π‘‰ μƒμ„ κ³„μΈµμ—μ„ λ΅λ“ λ¶„μ‚° --> μ„¬μ„Έν• λΌμ°ν…
π‘‰ μΊμ‹± κΈ°λ¥ μ κ³µ
π‘‰ λΉ„μ •μƒ νΈλν”½ ν•„ν„°λ§μΌλ΅ λ³΄μ• λ†’μ

#### π‘λ‹¨μ 
> π‘‰ κ°€κ²©μ΄ λ†’μ
π‘‰ ν¨ν‚·μ λ‚΄μ©μ„ λ³µνΈν™” ---> μμ› λΉ„μ© μ¦κ°€
π‘‰ μΈμ¦μ„λ¥Ό κ³µμ ν•΄μ•Όν•΄μ„ κ³µκ²©μκ°€ λ΅λ“λ°Έλ°μ„λ¥Ό ν†µν• ν΄λΌμ΄μ–ΈνΈ λ°μ΄ν„°μ— μ ‘κ·Ό κ°€λ¥

## λ§λ¬΄λ¦¬
λ΅λ“ λ°Έλ°μ„λ¥Ό ν†µν•΄μ„ μ–΄λ–»κ² νΈλν”½μ„ μ²λ¦¬ν•λ” λ°©μ‹μ΄ μλ”μ§€ μ•μ•„λ΄¤λ‹¤.
λ‚λ” AWSμ λ΅λ“λ°Έλ°μ„μ μ–΄ν”λ¦¬μΌ€μ΄μ… λ°Έλ°μ„μ™€ λ„¤νΈμ›ν¬ λ°Έλ°μ„λ¥Ό μ“°λ ¤κ³  ν•λ”λ° μ΄ μ •λ¦¬λ³Έμ— κΈ°λ°ν•μ—¬ AWS λ΅λ“λ°Έλ°μ„λ¥Ό λ¦¬λ·°ν•κ³  ν„μ¬ μ•„ν‚¤ν…μ²μ— μ ν•©ν• λ΅λ“ λ°Έλ°μ¤λ¥Ό ν•λ² μ•μ•„λ³΄κ² λ‹¤.

